# ğŸš¨ è·¯å¾„åµŒå¥—é—®é¢˜æ·±åº¦åˆ†æ

**åˆ†ææ—¥æœŸ**: 2025-11-27  
**åˆ†æç»“è®º**: âŒ **å½“å‰è®¾è®¡å­˜åœ¨ä¸¥é‡è·¯å¾„åµŒå¥—é—®é¢˜**

---

## ğŸ“Š é—®é¢˜ç°çŠ¶

### æœ¬åœ°ç»“æ„

```
/Users/xulin/è‡ªå·±çš„gitHubå’Œé¡¹ç›®/liner26698/vue3DataPlatform/
â”œâ”€â”€ server/                          â† ç¬¬1å±‚ server
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ koaapp-production.js        â† å¯åŠ¨æ–‡ä»¶åœ¨è¿™é‡Œ
â”‚   â””â”€â”€ scheduleCrawler.js
â”œâ”€â”€ src/
â”œâ”€â”€ package.json
â””â”€â”€ ecosystem.config.js
```

### æœåŠ¡å™¨ç»“æ„

```
/home/dataPlatform/
â”œâ”€â”€ server/                          â† ç¬¬2å±‚ serverï¼ˆå¤–å±‚ï¼‰
â”‚   â”œâ”€â”€ server/                      â† ç¬¬3å±‚ serverï¼ˆå†…å±‚ï¼‰ğŸš¨
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ koaapp-production.js
â”‚   â”‚   â””â”€â”€ scheduleCrawler.js
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ dist/
â”‚   â”œâ”€â”€ node_modules/
â”‚   â””â”€â”€ ...å…¶ä»–æ–‡ä»¶
â”œâ”€â”€ ecosystem.config.js
â”œâ”€â”€ package.json
â””â”€â”€ ... å…¶ä»–æ–‡ä»¶
```

### è·¯å¾„åµŒå¥—å…³ç³»åˆ†æ

| é¡¹ç›®         | æœ¬åœ°                            | æœåŠ¡å™¨                                 | é—®é¢˜          |
| ------------ | ------------------------------- | -------------------------------------- | ------------- |
| Koa å¯åŠ¨æ–‡ä»¶ | `./server/koaapp-production.js` | `./server/server/koaapp-production.js` | âŒ å¤šå±‚åµŒå¥—   |
| ç›¸å¯¹è·¯å¾„å¼•ç”¨ | `require("./routes")`           | `require("./routes")`                  | âš ï¸ ä¸Šä¸‹æ–‡æ··ä¹± |
| è·¯ç”±ä½ç½®     | `./server/routes/`              | `./server/server/routes/`              | âŒ æ··ä¹±       |
| æºä»£ç        | `./src/`                        | `./server/src/`                        | âŒ æ··ä¹±       |

---

## ğŸ”´ æ½œåœ¨çš„ä¸¥é‡é—®é¢˜

### é—®é¢˜ 1: è·¯å¾„æ··ä¹±å¯¼è‡´çš„å‘

å½“ä½ çœ‹åˆ° `ecosystem.config.js` ä¸­çš„é…ç½®ï¼š

```javascript
script: "/home/dataPlatform/server/koaapp-production.js";
```

**ä½ ä¼šå›°æƒ‘**ï¼š

- è¿™ä¸ª `server` æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ
- è¿™ä¸ªè·¯å¾„å¯¹åº”æœ¬åœ°çš„å“ªä¸ª `server`ï¼Ÿ
- ä¸‹æ¬¡éƒ¨ç½²æ˜¯å¦è¿˜è¦ä¿®æ”¹ç›¸å¯¹è·¯å¾„ï¼Ÿ

### é—®é¢˜ 2: æ–‡ä»¶åŒæ­¥æ—¶çš„éšæ‚£

å½“ä½¿ç”¨ `git pull` åŒæ­¥ä»£ç æ—¶ï¼š

- Git ä»æœ¬åœ° `./server/` æ‹‰å–æ–‡ä»¶
- ä½†è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„ `/home/dataPlatform/server/server/`
- è¿™ç§"ä¸å¯¹ç§°"å®¹æ˜“å¯¼è‡´åŒæ­¥é”™è¯¯

### é—®é¢˜ 3: ç»´æŠ¤å’Œè°ƒè¯•çš„æˆæœ¬

- å¼€å‘è€…éœ€è¦ä¸æ–­æ€è€ƒ"å½“å‰çš„ server æ–‡ä»¶å¤¹æ˜¯ç¬¬å‡ å±‚"
- çº¿ä¸Šé—®é¢˜æ’æŸ¥æ—¶ï¼Œè·¯å¾„é”™è¯¯ä¼šè¢«éšè—å¾ˆæ·±
- æ–°å›¢é˜Ÿæˆå‘˜å­¦ä¹ æˆæœ¬é«˜

### é—®é¢˜ 4: ç›¸å¯¹è·¯å¾„çš„äºŒä¹‰æ€§

åœ¨ `koaapp-production.js` ä¸­ï¼š

```javascript
const router = require("./routes");
```

**è¿™ä¸ª `./routes` çœŸçš„æŒ‡å‘æ­£ç¡®çš„ä½ç½®å—ï¼Ÿ**

- å¦‚æœæ–‡ä»¶åœ¨ `/home/dataPlatform/server/koaapp-production.js`
- å®ƒæŒ‡å‘ `/home/dataPlatform/server/routes` âœ…
- ä½†è¿™ä¸æœ¬åœ°ä»£ç çš„é€»è¾‘ä¸ä¸€è‡´ âš ï¸

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šå½»åº•æ‰å¹³åŒ–ï¼ˆæ¨èï¼‰â­â­â­

**ç›®æ ‡**: ä½¿æœ¬åœ°å’ŒæœåŠ¡å™¨çš„ç›®å½•å®Œå…¨å¯¹ç§°

#### æœ¬åœ°è°ƒæ•´

```
/Users/xulin/è‡ªå·±çš„gitHubå’Œé¡¹ç›®/liner26698/vue3DataPlatform/
â”œâ”€â”€ backend/                        â† æ”¹åï¼šserver â†’ backend
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ koaapp-production.js
â”‚   â””â”€â”€ scheduleCrawler.js
â”œâ”€â”€ frontend/                       â† æ”¹åï¼šsrc â†’ frontend
â”œâ”€â”€ package.json
â””â”€â”€ ecosystem.config.js
```

#### æœåŠ¡å™¨è°ƒæ•´

```
/home/dataPlatform/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ utils/
â”‚   â””â”€â”€ koaapp-production.js
â”œâ”€â”€ frontend/
â”œâ”€â”€ package.json
â”œâ”€â”€ ecosystem.config.js
â””â”€â”€ ...
```

**ä¼˜ç‚¹**:

- âœ… æœ¬åœ°å’ŒæœåŠ¡å™¨å®Œå…¨å¯¹ç§°
- âœ… æ— ä»»ä½•åµŒå¥—å…³ç³»
- âœ… ä¸€çœ¼å°±èƒ½ç†è§£è·¯å¾„å«ä¹‰
- âœ… ç›¸å¯¹è·¯å¾„å¼•ç”¨ä¸€è‡´

**ç¼ºç‚¹**:

- âš ï¸ éœ€è¦é‡å‘½åæ‰€æœ‰æ–‡ä»¶å¤¹å’Œå¼•ç”¨

---

### æ–¹æ¡ˆ Bï¼šæœåŠ¡å™¨æ”¹åï¼ˆæŠ˜è¡·æ–¹æ¡ˆï¼‰â­â­

**åªæ”¹æœåŠ¡å™¨ç«¯**: å°† `/home/dataPlatform/server/` æ”¹ä¸ºå…¶ä»–åç§°

#### å½“å‰é—®é¢˜ç»“æ„

```
/home/dataPlatform/
â”œâ”€â”€ server/              â† è¿™ä¸ª server å…¶å®æ˜¯é¡¹ç›®æ ¹ç›®å½•
â”‚   â”œâ”€â”€ server/          â† è¿™ä¸ª server æ‰æ˜¯åç«¯ä»£ç 
```

#### æ”¹ä¸º

```
/home/dataPlatform/
â”œâ”€â”€ project/             â† æˆ– app / app-root
â”‚   â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ ...
```

**ä¼˜ç‚¹**:

- âœ… å®Œå…¨æ¶ˆé™¤åµŒå¥—æ··ä¹±
- âœ… æœåŠ¡å™¨ç«¯æ›´æ¸…æ™°
- âš ï¸ åªéœ€ä¿®æ”¹ ecosystem.config.js çš„è·¯å¾„

**ç¼ºç‚¹**:

- âš ï¸ éœ€è¦ä¿®æ”¹ PM2 é…ç½®

---

### æ–¹æ¡ˆ Cï¼šä¿æŒç°çŠ¶ä½†æ ‡å‡†åŒ–æ–‡æ¡£ï¼ˆæœ€å°é£é™©ï¼‰â­

**ä¸æ”¹ç»“æ„ï¼Œä½†æ·»åŠ æ˜ç¡®çš„è·¯å¾„çº¦å®š**

åœ¨æ‰€æœ‰å…³é”®æ–‡ä»¶é¡¶éƒ¨æ·»åŠ è·¯å¾„æ˜ å°„æ³¨é‡Šï¼š

```javascript
/**
 * è·¯å¾„è¯´æ˜:
 * æœ¬åœ°: /Users/xulin/.../vue3DataPlatform/server/koaapp-production.js
 * æœåŠ¡å™¨: /home/dataPlatform/server/koaapp-production.js
 *
 * å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•è¢«è§†ä¸º"é¡¹ç›®æ ¹ç›®å½•"ï¼Œç›¸å¯¹è·¯å¾„åŸºäºæ­¤
 */
```

**ä¼˜ç‚¹**:

- âœ… é›¶é£é™©
- âœ… å¿«é€Ÿå®æ–½

**ç¼ºç‚¹**:

- âŒ æ ¹æœ¬ä¸Šæ²¡æœ‰è§£å†³åµŒå¥—é—®é¢˜
- âŒ åªæ˜¯çº¸ä¸Šè°ˆå…µ

---

## ğŸ¯ æˆ‘çš„å»ºè®®

### çŸ­æœŸï¼ˆç«‹å³ï¼‰

- **é‡‡ç”¨æ–¹æ¡ˆ C**: åœ¨ `koaapp-production.js` å’Œæ‰€æœ‰å…³é”®è·¯ç”±æ–‡ä»¶ä¸­æ·»åŠ æ¸…æ™°æ³¨é‡Š
- **æ›´æ–°æ–‡æ¡£**: åœ¨ `DIRECTORY_STRUCTURE.md` ä¸­æ˜ç¡®è¯´æ˜è·¯å¾„æ˜ å°„å…³ç³»

### ä¸­æœŸï¼ˆä¸‹ä¸ªè¿­ä»£ï¼‰

- **é‡‡ç”¨æ–¹æ¡ˆ B**: æ”¹æœåŠ¡å™¨çš„ç›®å½•ç»“æ„ä¸º `/home/dataPlatform/app/`
- **éªŒè¯æ‰€æœ‰ä¾èµ–**: ç¡®ä¿æ”¹åŠ¨ä¸å½±å“ Nginx å’Œå…¶ä»–é…ç½®

### é•¿æœŸï¼ˆæ¶æ„ä¼˜åŒ–ï¼‰

- **é‡‡ç”¨æ–¹æ¡ˆ A**: å½»åº•é‡æ„æœ¬åœ°å’ŒæœåŠ¡å™¨çš„ç›®å½•ç»“æ„
- **åˆ›å»ºè¿ç§»è„šæœ¬**: è‡ªåŠ¨åŒ–å¤„ç†å¤§è§„æ¨¡é‡å‘½å
- **å»ºç«‹æœ€ä½³å®è·µ**: ä¸ºå›¢é˜Ÿå®šç«‹æ¸…æ™°çš„ç›®å½•è§„èŒƒ

---

## ğŸ“‹ æ–¹æ¡ˆ B çš„å…·ä½“å®æ–½æ­¥éª¤

### æ­¥éª¤ 1: æ£€æŸ¥å½“å‰å¼•ç”¨

```bash
# æ‰¾å‡ºæ‰€æœ‰å¼•ç”¨ /home/dataPlatform/server/ çš„åœ°æ–¹
grep -r "dataPlatform/server" /home/dataPlatform/
```

### æ­¥éª¤ 2: åˆ›å»ºæ–°ç›®å½•å¹¶è¿ç§»

```bash
cd /home/dataPlatform
mkdir app
cp -r server/* app/
```

### æ­¥éª¤ 3: æ›´æ–° PM2 é…ç½®

```javascript
// ecosystem.config.js
{
	script: "/home/dataPlatform/app/koaapp-production.js"; // â† æ”¹è¿™é‡Œ
}
```

### æ­¥éª¤ 4: éªŒè¯å’Œæ¸…ç†

```bash
pm2 restart all
pm2 logs
# ç¡®è®¤ä¸€åˆ‡æ­£å¸¸å
rm -rf /home/dataPlatform/server/
```

---

## ğŸ” ç›¸å…³æ–‡ä»¶æ¸…å•

éœ€è¦æ£€æŸ¥å’Œæ›´æ–°çš„æ–‡ä»¶ï¼š

- [ ] `ecosystem.config.js` - å¯åŠ¨è„šæœ¬è·¯å¾„
- [ ] `koaapp-production.js` - å†…éƒ¨ require è·¯å¾„
- [ ] `scheduleCrawler.js` - å†…éƒ¨ require è·¯å¾„
- [ ] `routes/index.js` - å†…éƒ¨ require è·¯å¾„
- [ ] Nginx é…ç½®ï¼ˆå¦‚æœæœ‰å¼•ç”¨ï¼‰
- [ ] éƒ¨ç½²è„šæœ¬ - è·¯å¾„é…ç½®

---

## ğŸ’¡ æœ€ç»ˆç»“è®º

**ä½ çš„ç›´è§‰æ˜¯æ­£ç¡®çš„**ã€‚å½“å‰çš„åŒå±‚ `server` åµŒå¥—è™½ç„¶"èƒ½ç”¨"ï¼Œä½†ç¡®å®å®¹æ˜“é€ æˆï¼š

1. **ç†è§£ä¸Šçš„æ··ä¹±** - å¼€å‘è€…ä¸çŸ¥é“å“ªä¸ª server æŒ‡å“ªä¸ª
2. **ç»´æŠ¤ä¸Šçš„å›°éš¾** - ä¿®æ”¹è·¯å¾„æ—¶å®¹æ˜“å‡ºé”™
3. **æ‰©å±•ä¸Šçš„éšæ‚£** - æ·»åŠ æ–°æœåŠ¡æ—¶å®¹æ˜“å¿˜è®°æ›´æ–°è·¯å¾„

**å»ºè®®ä¼˜å…ˆçº§**:

1. ğŸ¥‡ **ç«‹å³**: æ·»åŠ æ¸…æ™°çš„è·¯å¾„æ³¨é‡Šå’Œæ–‡æ¡£ï¼ˆæ–¹æ¡ˆ Cï¼‰
2. ğŸ¥ˆ **ä¸‹å‘¨**: é‡æ„æœåŠ¡å™¨ç›®å½•ä¸º `/home/dataPlatform/app/`ï¼ˆæ–¹æ¡ˆ Bï¼‰
3. ğŸ¥‰ **æœªæ¥**: è€ƒè™‘æœ¬åœ°ç›®å½•ä¹Ÿæ”¹ä¸º `backend/` + `frontend/`ï¼ˆæ–¹æ¡ˆ Aï¼‰

è¿™æ ·å¯ä»¥åœ¨æœ€å°é£é™©çš„æƒ…å†µä¸‹ï¼Œé€æ­¥æ”¹è¿›é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€‚
